/*
 * Decompiled with CFR 0.152.
 * 
 * Could not load the following classes:
 *  org.apache.commons.lang3.StringUtils
 */
package me.moon.module.impl.exploit;

import java.awt.Color;
import java.util.ArrayList;
import me.moon.event.Handler;
import me.moon.event.impl.game.PacketEvent;
import me.moon.event.impl.game.WorldLoadEvent;
import me.moon.event.impl.player.UpdateEvent;
import me.moon.module.Module;
import me.moon.utils.MathUtils;
import me.moon.utils.game.Printer;
import me.moon.utils.game.ServerUtils;
import me.moon.utils.game.TimerUtil;
import me.moon.utils.value.impl.EnumValue;
import net.minecraft.network.Packet;
import net.minecraft.network.play.INetHandlerPlayClient;
import net.minecraft.network.play.INetHandlerPlayServer;
import net.minecraft.network.play.client.C00PacketKeepAlive;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C08PacketPlayerBlockPlacement;
import net.minecraft.network.play.client.C0BPacketEntityAction;
import net.minecraft.network.play.client.C0CPacketInput;
import net.minecraft.network.play.client.C0FPacketConfirmTransaction;
import net.minecraft.network.play.client.C13PacketPlayerAbilities;
import net.minecraft.network.play.server.S08PacketPlayerPosLook;
import net.minecraft.network.play.server.S12PacketEntityVelocity;
import net.minecraft.network.play.server.S32PacketConfirmTransaction;
import net.minecraft.util.BlockPos;
import org.apache.commons.lang3.StringUtils;

public class Disabler
extends Module {
    public static final EnumValue<Mode> mode = new EnumValue<Mode>("Mode", Mode.WATCHDOG);
    private final TimerUtil timer = new TimerUtil();
    public int disabilityCounter;
    public int i;
    public ArrayList<Packet> packetList = new ArrayList();
    public ArrayList<Packet> cubePackets = new ArrayList();
    private ArrayList<Packet> hypixelPackets = new ArrayList();
    private boolean sent;
    private boolean isEnabled;
    private double stage;
    private double counter;

    public Disabler() {
        super("Disabler", Module.Category.EXPLOITS, new Color(0).getRGB());
        this.setDescription("Anticheat disabler");
    }

    @Handler(value=WorldLoadEvent.class)
    public void onWorldLoad(WorldLoadEvent event) {
        if (mode.getValue() == Mode.WATCHDOG) {
            this.counter = 0.0;
        }
    }

    /*
     * Enabled force condition propagation
     * Lifted jumps to return sites
     */
    @Handler(value=PacketEvent.class)
    public void onPacket(PacketEvent event) {
        switch ((Mode)((Object)mode.getValue())) {
            case VELIX: {
                return;
            }
            case WATCHDOG: {
                if (this.mc.thePlayer == null || !ServerUtils.isOnHypixel() || event.isSending() || !(event.getPacket() instanceof S32PacketConfirmTransaction) || ((S32PacketConfirmTransaction)event.getPacket()).getActionNumber() >= 0) return;
                event.setCancelled(true);
                return;
            }
            case WATCHDOGDEV: {
                if (this.mc.thePlayer == null || !ServerUtils.isOnHypixel()) return;
                if (!event.isSending() && event.getPacket() instanceof S32PacketConfirmTransaction && ((S32PacketConfirmTransaction)event.getPacket()).getActionNumber() < 0) {
                    event.setCancelled(true);
                }
                if (!event.isSending() || !(event.getPacket() instanceof C00PacketKeepAlive)) return;
                event.setCancelled(true);
                return;
            }
            case POSCANCEL: {
                if (!event.isSending() || !(event.getPacket() instanceof C03PacketPlayer) || this.mc.thePlayer.ticksExisted % 3 == 0) return;
                event.setCancelled(true);
                return;
            }
            case NOPAYLOAD: {
                if (this.mc.thePlayer == null || this.mc.theWorld == null) {
                    return;
                }
                if (event.getPacket() instanceof C00PacketKeepAlive) {
                    C00PacketKeepAlive c00PacketKeepAlive = (C00PacketKeepAlive)event.getPacket();
                    --c00PacketKeepAlive.key;
                }
                if (event.getPacket() instanceof C0FPacketConfirmTransaction) {
                    C0FPacketConfirmTransaction transaction = (C0FPacketConfirmTransaction)event.getPacket();
                    transaction.uid = (short)(transaction.uid - 6);
                }
                if (!(event.getPacket() instanceof C03PacketPlayer)) return;
                float yaw = this.mc.thePlayer.rotationYaw;
                float pitch = this.mc.thePlayer.rotationPitch;
                if (this.mc.thePlayer.ticksExisted % 3 == 0) {
                    if (event.getPacket() instanceof C03PacketPlayer.C04PacketPlayerPosition) {
                        event.setPacket(new C03PacketPlayer.C06PacketPlayerPosLook(this.mc.thePlayer.posX, this.mc.thePlayer.posY, this.mc.thePlayer.posZ, yaw, pitch, this.mc.thePlayer.onGround));
                        return;
                    }
                    if (event.getPacket() instanceof C03PacketPlayer.C05PacketPlayerLook || event.getPacket() instanceof C03PacketPlayer.C06PacketPlayerPosLook) {
                        C03PacketPlayer packetPlayer = (C03PacketPlayer)event.getPacket();
                        event.setPacket(new C03PacketPlayer.C06PacketPlayerPosLook(this.mc.thePlayer.posX, this.mc.thePlayer.posY, this.mc.thePlayer.posZ, packetPlayer.getYaw(), packetPlayer.getPitch(), this.mc.thePlayer.onGround));
                        return;
                    }
                    event.setPacket(new C03PacketPlayer.C06PacketPlayerPosLook(this.mc.thePlayer.posX, this.mc.thePlayer.posY, this.mc.thePlayer.posZ, yaw, pitch, this.mc.thePlayer.onGround));
                    return;
                }
                if (this.mc.thePlayer.ticksExisted % 200 != 0) {
                    event.setCancelled(true);
                    return;
                }
                this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C03PacketPlayer.C04PacketPlayerPosition(-6.0, 256.0, -8.0, false));
                this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C03PacketPlayer.C04PacketPlayerPosition(-6.0, 256.0, -8.0, true));
                return;
            }
            case TIMEOUT: {
                if (event.isSending() && event.getPacket() instanceof C0FPacketConfirmTransaction) {
                    event.setCancelled(true);
                }
                if (!event.isSending() || !(event.getPacket() instanceof C00PacketKeepAlive)) return;
                C00PacketKeepAlive packet = (C00PacketKeepAlive)event.getPacket();
                event.setCancelled(true);
                return;
            }
            case VEHICLE: {
                if (!event.isSending() || !(event.getPacket() instanceof C03PacketPlayer)) return;
                this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C0CPacketInput(this.mc.thePlayer.moveStrafing, this.mc.thePlayer.moveForward, this.mc.thePlayer.movementInput.jump, this.mc.thePlayer.movementInput.sneak));
                return;
            }
            case FAITHFUL: {
                if (this.mc.thePlayer == null || !event.isSending() || !(event.getPacket() instanceof C03PacketPlayer)) return;
                event.setCancelled(true);
                if (this.i > 2) {
                    this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C03PacketPlayer.C06PacketPlayerPosLook(this.mc.thePlayer.prevPosX + (this.mc.thePlayer.posX - this.mc.thePlayer.prevPosX) / 3.0, this.mc.thePlayer.prevPosY + (this.mc.thePlayer.posY - this.mc.thePlayer.prevPosY) / 3.0, this.mc.thePlayer.prevPosZ + (this.mc.thePlayer.posZ - this.mc.thePlayer.prevPosZ) / 3.0, this.mc.thePlayer.rotationYaw, this.mc.thePlayer.rotationPitch, true));
                    this.i = 0;
                } else {
                    this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C00PacketKeepAlive(-2147483647));
                }
                ++this.i;
                return;
            }
            case FAITHFUL2: {
                Packet<INetHandlerPlayServer> packet;
                if (this.mc.thePlayer == null || !event.isSending() || event.getPacket() instanceof C08PacketPlayerBlockPlacement) {
                    // empty if block
                }
                if (this.mc.thePlayer != null && event.isSending() && event.getPacket() instanceof C03PacketPlayer) {
                    packet = (C03PacketPlayer)event.getPacket();
                    ((C03PacketPlayer)packet).setOnGround(false);
                }
                if (!event.isSending() || !(event.getPacket() instanceof C13PacketPlayerAbilities)) return;
                packet = (C13PacketPlayerAbilities)event.getPacket();
                return;
            }
            case FAITHFUL3: {
                C0FPacketConfirmTransaction packet;
                if (!event.isSending() || !(event.getPacket() instanceof C0FPacketConfirmTransaction) || (packet = (C0FPacketConfirmTransaction)event.getPacket()).getWindowId() == 0) {
                    // empty if block
                }
                if (event.getPacket() instanceof C00PacketKeepAlive) {
                    // empty if block
                }
                if (!event.isSending() || this.mc.thePlayer.isDead) return;
                if (this.mc.thePlayer.ticksExisted % 2 != 0) {
                    boolean entityAction = event.getPacket() instanceof C0BPacketEntityAction && (((C0BPacketEntityAction)event.getPacket()).getAction() == C0BPacketEntityAction.Action.START_SPRINTING || ((C0BPacketEntityAction)event.getPacket()).getAction() == C0BPacketEntityAction.Action.STOP_SPRINTING);
                    boolean ping = event.getPacket() instanceof C0FPacketConfirmTransaction && ((C0FPacketConfirmTransaction)event.getPacket()).getWindowId() == 0 || event.getPacket() instanceof C00PacketKeepAlive;
                    event.setCancelled(true);
                    if (entityAction || ping) return;
                    this.packetList.add(event.getPacket());
                    return;
                }
                if (this.packetList.isEmpty()) return;
                this.packetList.forEach(this.mc.thePlayer.sendQueue.getNetworkManager()::sendPacket);
                this.packetList.clear();
                return;
            }
            case SENTINEL: {
                Packet<INetHandlerPlayClient> packet;
                if (event.getPacket() instanceof S08PacketPlayerPosLook) {
                    packet = (S08PacketPlayerPosLook)event.getPacket();
                    this.cubePackets.clear();
                }
                if (event.isSending() && event.getPacket() instanceof C0FPacketConfirmTransaction) {
                    packet = (C0FPacketConfirmTransaction)event.getPacket();
                    event.setCancelled(true);
                    this.cubePackets.add(event.getPacket());
                    if (((C0FPacketConfirmTransaction)packet).getWindowId() != 0) {
                        Printer.print("Clear transaction " + this.cubePackets.size());
                        this.cubePackets.forEach(this.mc.thePlayer.sendQueue.getNetworkManager()::sendPacket);
                        this.cubePackets.clear();
                        this.disabilityCounter = MathUtils.getRandomInRange(350, 400);
                    }
                }
                if (event.isSending() && event.getPacket() instanceof C00PacketKeepAlive) {
                    packet = (C00PacketKeepAlive)event.getPacket();
                    event.setCancelled(true);
                    this.cubePackets.add(event.getPacket());
                }
                if (!(event.getPacket() instanceof C03PacketPlayer)) return;
                this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C0CPacketInput(this.mc.thePlayer.moveStrafing, this.mc.thePlayer.moveForward, this.mc.thePlayer.movementInput.jump, this.mc.thePlayer.movementInput.sneak));
                return;
            }
            case DEV: {
                Packet<INetHandlerPlayServer> packet;
                if (event.isSending() && event.getPacket() instanceof C03PacketPlayer) {
                    packet = (C03PacketPlayer)event.getPacket();
                }
                if (event.isSending() || event.getPacket() instanceof S12PacketEntityVelocity) {
                    // empty if block
                }
                if (!event.isSending() && event.getPacket() instanceof S08PacketPlayerPosLook) {
                    this.sent = true;
                }
                if (event.isSending() || !(event.getPacket() instanceof S32PacketConfirmTransaction)) return;
                packet = (S32PacketConfirmTransaction)event.getPacket();
                Printer.print("" + ((S32PacketConfirmTransaction)packet).getActionNumber());
                if (!this.sent) return;
            }
            case SLOTH: {
                C03PacketPlayer packet;
                if (!event.isSending() || !(event.getPacket() instanceof C03PacketPlayer) || !(packet = (C03PacketPlayer)event.getPacket()).isMoving()) return;
                packet.setY(packet.getPositionY() + 1.0E-4);
                return;
            }
            case TROJAN: {
                C0FPacketConfirmTransaction packet;
                if (!event.isSending()) return;
                if (event.getPacket() instanceof C00PacketKeepAlive) {
                    this.packetList.add(event.getPacket());
                    event.setCancelled(true);
                }
                if (!(event.getPacket() instanceof C0FPacketConfirmTransaction) || (packet = (C0FPacketConfirmTransaction)event.getPacket()).getWindowId() != 0) return;
                this.packetList.add(event.getPacket());
                event.setCancelled(true);
                return;
            }
            case VERUS_SEMI: {
                if (!event.isSending() || this.mc.thePlayer.isDead) return;
                if (this.mc.thePlayer.ticksExisted % 2 != 0) {
                    boolean entityAction = event.getPacket() instanceof C0BPacketEntityAction && (((C0BPacketEntityAction)event.getPacket()).getAction() == C0BPacketEntityAction.Action.START_SPRINTING || ((C0BPacketEntityAction)event.getPacket()).getAction() == C0BPacketEntityAction.Action.STOP_SPRINTING);
                    event.setCancelled(true);
                    if (entityAction) return;
                    this.packetList.add(event.getPacket());
                    return;
                }
                if (this.packetList.isEmpty()) return;
                this.packetList.forEach(this.mc.thePlayer.sendQueue.getNetworkManager()::sendPacket);
                this.packetList.clear();
                return;
            }
        }
    }

    @Handler(value=UpdateEvent.class)
    public void onUpdate(UpdateEvent event) {
        if (event.isPre()) {
            this.setSuffix(StringUtils.capitalize((String)((Mode)((Object)mode.getValue())).getName()));
        }
        switch ((Mode)((Object)mode.getValue())) {
            case TROJAN: {
                if (!event.isPre()) break;
                this.counter += 1.0;
                if (this.counter == 1.0) {
                    event.setCancelled(true);
                    this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C03PacketPlayer.C04PacketPlayerPosition(this.mc.thePlayer.posX, this.mc.thePlayer.posY - 11.0, this.mc.thePlayer.posZ, false));
                    break;
                }
                if (this.counter == 2.0) {
                    this.packetList.forEach(this.mc.thePlayer.sendQueue.getNetworkManager()::sendPacket);
                    this.packetList.clear();
                    break;
                }
                if (!(this.counter >= 150.0)) break;
                this.counter = 0.0;
                break;
            }
            case DEV: {
                if (!event.isPre()) break;
                break;
            }
            case SLOTH: {
                double d;
                if (!event.isPre()) break;
                this.stage += 1.0;
                if (!(d <= 1.0)) break;
                this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C03PacketPlayer.C04PacketPlayerPosition(this.mc.thePlayer.posX, this.mc.thePlayer.posY + 11.0, this.mc.thePlayer.posZ, false));
                break;
            }
            case VELIX: {
                break;
            }
            case FAITHFUL3: {
                break;
            }
            case SPECTATOR: {
                if (!event.isPre()) break;
                break;
            }
            case TRANSACTION_SPAM: {
                if (!event.isPre()) break;
                this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C0FPacketConfirmTransaction(0, (short)MathUtils.getRandomInRange(-32767, Short.MAX_VALUE), false));
                break;
            }
            case NULLPLACE: {
                if (!event.isPre()) break;
                BlockPos pos = new BlockPos(this.mc.thePlayer.posX, this.mc.thePlayer.posY - 1.0, this.mc.thePlayer.posZ);
                this.mc.thePlayer.sendQueue.addToSendQueueNoEvents(new C08PacketPlayerBlockPlacement(pos, 1, null, 0.0f, 0.0f, 0.0f));
                break;
            }
            case WATCHDOG: {
                break;
            }
            case SENTINEL: {
                if (!event.isPre() || !this.timer.sleep(this.disabilityCounter)) break;
                Printer.print("Sending uwu " + this.cubePackets.size());
                this.cubePackets.forEach(this.mc.thePlayer.sendQueue.getNetworkManager()::sendPacket);
                this.cubePackets.clear();
                this.disabilityCounter = MathUtils.getRandomInRange(950, 1000);
                break;
            }
        }
    }

    @Override
    public void onEnable() {
        if (this.mc.theWorld == null) {
            return;
        }
        this.disabilityCounter = MathUtils.getRandomInRange(2550, 2650);
        this.timer.reset();
        this.sent = false;
        this.i = 0;
        this.hypixelPackets.clear();
        this.isEnabled = false;
        this.stage = 0.0;
        this.counter = 0.0;
    }

    @Override
    public void onDisable() {
        if (this.mc.theWorld == null) {
            return;
        }
        this.mc.timer.timerSpeed = 1.0f;
        this.packetList.forEach(this.mc.thePlayer.sendQueue.getNetworkManager()::sendPacket);
        this.cubePackets.forEach(this.mc.thePlayer.sendQueue.getNetworkManager()::sendPacket);
        this.cubePackets.clear();
        this.packetList.clear();
    }

    public static enum Mode {
        WATCHDOG("Watchdog"),
        WATCHDOGDEV("Watchdog Dev"),
        SENTINEL("Sentinel"),
        DEV("Dev"),
        VERUS_SEMI("Verus_Semi"),
        SLOTH("Sloth"),
        TROJAN("Trojan"),
        FAITHFUL("Faithful"),
        FAITHFUL2("Faithful2"),
        FAITHFUL3("Faithful3"),
        TIMEOUT("Timeout"),
        NOPAYLOAD("NoPayload"),
        POSCANCEL("PosCancel"),
        NULLPLACE("NullPlace"),
        TRANSACTION_SPAM("TransactionSpam"),
        SPECTATOR("Spectator"),
        VEHICLE("Vehicle"),
        VELIX("Velix");

        private final String name;

        private Mode(String name) {
            this.name = name;
        }

        public String getName() {
            return this.name;
        }
    }
}

