/*
 * Decompiled with CFR 0.152.
 * 
 * Could not load the following classes:
 *  org.lwjgl.input.Mouse
 */
package me.moon.module.impl.exploit;

import java.awt.Color;
import me.moon.event.Handler;
import me.moon.event.impl.game.PacketEvent;
import me.moon.event.impl.player.UpdateEvent;
import me.moon.module.Module;
import me.moon.utils.value.impl.EnumValue;
import net.minecraft.client.Minecraft;
import net.minecraft.item.ItemBow;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C07PacketPlayerDigging;
import net.minecraft.network.play.client.C08PacketPlayerBlockPlacement;
import net.minecraft.util.BlockPos;
import net.minecraft.util.EnumFacing;
import org.lwjgl.input.Mouse;

public class Fastbow
extends Module {
    private final EnumValue<Mode> mode = new EnumValue<Mode>("Mode", Mode.NORMAL);
    private final EnumValue<phasingModes> phasingMode = new EnumValue<phasingModes>("Request Mode", phasingModes.NORMAL, this.mode, "Request");
    private double stage;
    private double counter;
    private double posY;

    public Fastbow() {
        super("Fastbow", Module.Category.EXPLOITS, new Color(5090969).getRGB());
        this.setDescription("Shoot Faster.");
    }

    @Override
    public void onEnable() {
    }

    @Handler(value=UpdateEvent.class)
    public void onUpdate(UpdateEvent event) {
        if (event.isPre()) {
            switch ((Mode)((Object)this.mode.getValue())) {
                case NORMAL: {
                    if (!event.isPre()) break;
                    if (this.mc.thePlayer == null || this.mc.thePlayer.getCurrentEquippedItem() == null) {
                        return;
                    }
                    if (!Mouse.isButtonDown((int)1) || !(this.mc.thePlayer.getCurrentEquippedItem().getItem() instanceof ItemBow) || !this.mc.thePlayer.onGround) break;
                    this.mc.thePlayer.sendQueue.addToSendQueue(new C08PacketPlayerBlockPlacement(this.mc.thePlayer.inventory.getCurrentItem()));
                    int power = 20 - this.mc.thePlayer.getItemInUseDuration();
                    for (int i = 0; i < power; ++i) {
                        this.mc.thePlayer.sendQueue.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(this.mc.thePlayer.posX, this.mc.thePlayer.posY, this.mc.thePlayer.posZ, this.mc.thePlayer.onGround));
                    }
                    this.mc.thePlayer.sendQueue.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.RELEASE_USE_ITEM, BlockPos.ORIGIN, EnumFacing.DOWN));
                    Minecraft.rightClickDelayTimer = 0;
                    break;
                }
            }
        }
    }

    @Handler(value=PacketEvent.class)
    public void onPacket(PacketEvent event) {
        switch ((Mode)((Object)this.mode.getValue())) {
            case NORMAL: {
                break;
            }
            case REQUEST: {
                if (!event.isSending() || !(event.getPacket() instanceof C03PacketPlayer)) break;
                if (this.mc.thePlayer == null || this.mc.thePlayer.getCurrentEquippedItem() == null) {
                    return;
                }
                if (Mouse.isButtonDown((int)1) && this.mc.thePlayer.getCurrentEquippedItem().getItem() instanceof ItemBow) {
                    C03PacketPlayer packet = (C03PacketPlayer)event.getPacket();
                    this.counter += 1.0;
                    switch ((phasingModes)((Object)this.phasingMode.getValue())) {
                        case NORMAL: {
                            packet.setY(packet.getPositionY() - 0.07);
                            break;
                        }
                        case PHASE: {
                            packet.setY(packet.getPositionY() - 1.0E-4);
                            break;
                        }
                        case DEV: {
                            packet.setY(packet.getPositionY() - 0.125);
                            packet.setOnGround(true);
                        }
                    }
                    if (this.counter >= 20.0) {
                        if (this.mc.thePlayer.getItemInUseDuration() > 0) {
                            this.mc.thePlayer.sendQueue.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.RELEASE_USE_ITEM, BlockPos.ORIGIN, EnumFacing.DOWN));
                        }
                        this.counter = 0.0;
                        break;
                    }
                    if (this.counter != 1.0) break;
                    this.mc.thePlayer.sendQueue.addToSendQueue(new C08PacketPlayerBlockPlacement(this.mc.thePlayer.inventory.getCurrentItem()));
                    break;
                }
                this.counter = 0.0;
            }
        }
    }

    private static enum phasingModes {
        NORMAL("Normal"),
        PHASE("Phase"),
        DEV("Dev");

        private final String name;

        private phasingModes(String name) {
            this.name = name;
        }

        public String getName() {
            return this.name;
        }
    }

    private static enum Mode {
        NORMAL("Normal"),
        REQUEST("Request");

        private final String name;

        private Mode(String name) {
            this.name = name;
        }

        public String getName() {
            return this.name;
        }
    }
}

